name: generate user-statistician

on:
  schedule:
    - cron: '42 5 * * *'
  
  # allows to manually run the job at any time
  workflow_dispatch:
  
  # run on every push on the master branch
  push:
    branches: [ master ]
    paths: [ '.github/workflows/userstats.yml' ]

jobs:
  stats:
    permissions: 
      contents: write
    runs-on: ubuntu-latest
    timeout-minutes: 10
      
    steps:
    - uses: actions/checkout@v4

    - name: Generate the user stats image for GitHub profile
      uses: cicirello/user-statistician@v1
      with:
        colors: dark-dimmed
        custom-title: My GitHub Statistics
        max-languages: 100
        animated-language-chart: true
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
    # push the content of <build_dir> to a branch
    # the content will be available at https://raw.githubusercontent.com/<github_user>/<repository>/<target_branch>/<file> , or as github page
    - name: push userstats.svg to the output branch
      uses: crazy-max/ghaction-github-pages@v3.1.0
      with:
        target_branch: output
        build_dir: dist
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

